DROP TABLE `account_devices`;
CREATE TABLE `account_push_subscriptions` ( `endpoint` VARCHAR(750) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , `keyAuth` VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , `keyPub` VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , `userId` INT(10) UNSIGNED NULL DEFAULT NULL , PRIMARY KEY (`endpoint`)) ENGINE = InnoDB;
ALTER TABLE `account_push_subscriptions` ADD CONSTRAINT `fk_account_push_subscriptions_userId` FOREIGN KEY (`userId`) REFERENCES `account_data`(`userId`) ON DELETE CASCADE ON UPDATE CASCADE;
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_subscription_endpoint_invalid', 'The provided endpoint is invalid.', 'Der übermittelte Endpunkt ist ungültig.'), ('account_push_subscription_keyAuth_invalid', 'The provided authentication key is invalid.', 'Der übermittelte Authorisierungsschlüssel ist ungültig.');
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_subscription_pubKey_invalid', 'The provided public key is invalid.', 'Der übermittelte öffentliche Schlüssel ist ungültig.');
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_subscription_subscribed', 'You have successfully subscribed.', 'Dein Abonnement wurde erfolgreich hinterlegt.');
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_subscription_unsubscribed', 'You have successfully unsubscribed.', 'Dein Abonnement wurde erfolgreich entfernt.');
DELETE FROM `strings` WHERE `identifier` = 'pn_send_registrationIds_invalid';
DELETE FROM `strings` WHERE `identifier` = 'pn_send_success';
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_notifications_sent_prefix', ' Push Notifications sent:\r\n', ' Push-Benachrichtigungen versandt:\r\n'), ('account_push_notifications_sent_successful', ' successful\r\n', ' erfolgreich\r\n');
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('account_push_notifications_sent_failed', ' failed\r\n(', ' fehlgeschlagen\r\n('), ('account_push_notifications_sent_expired', ' expired subscriptions)', ' abgelaufene Abonnements)');
UPDATE `strings` SET `de` = 'Wenn Sie Push-Benachrichtigungen von unserer Web-App empfangen möchten, können Sie dazu Ihre Einwilligung beim Einloggen erteilen. Sollten Sie später diese Einwilligung widerrufen wollen, ist dies in den Berechtigungen des Browsers oder durch das Ausloggen möglich.\r\n\r\nDer Service für das Zustellen der Push-Benachrichtigungen hängt von Ihrem verwendeten Browser ab. Beispielsweise nutzt Google Chrome \"Firebase Cloud Messenging\" oder Mozilla Firefox einen Service von Mozilla. Konsultieren Sie für weitere Informationen hierzu die Dokumentation/Rechtstexte ihres Browsers. Persönliche Daten werden bei der Nutzung der Push-Benachrichtigungen jedoch nicht an den entsprechenden Drittanbieter übertragen, sondern lediglich eine anonymisierte Zeichenkette und zugehörige Schlüssel für die verschlüsselte Zustellung der Push-Benachrichtigungen.\r\n\r\nRechtsgrundlage hierfür ist Art. 6 Abs. 1 lit. a der DSGVO.' WHERE `strings`.`identifier` = 'privacy_policy_data_type_consents_pn_paragraph';
DELETE from `strings` WHERE `identifier`='privacy_policy_technical_transfer_firebase_messaging_heading';
DELETE from `strings` WHERE `identifier`='privacy_policy_technical_transfer_firebase_messaging_paragraph';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_contact_diocese_wuerzburg_heading';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_contact_diocese_wuerzburg_paragraph';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_operator_diocese_wuerzburg_heading';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_operator_diocese_wuerzburg_paragraph';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_local_operator_diocese_wuerzburg_heading';
DELETE from `strings` WHERE `identifier`='privacy_policy_officials_caritas_local_operator_diocese_wuerzburg_paragraph';
INSERT INTO `strings` (`identifier`, `en`, `de`) VALUES ('privacy_policy_officials_congregation_heading', 'TBD', 'Ordensdatenschutzbeauftragte'), ('privacy_policy_officials_congregation_paragraph', 'TBD', 'Christine Haumer\r\nWittelsbacherring 9\r\n53115 Bonn\r\nTelefon: +49 170 6305415\r\nE-Mail: haumer@orden.de');
UPDATE `strings` SET `de` = 'Markus Schönmann, Justiziar\r\ndatenschutz süd GmbH\r\nWörthstraße 15\r\n97082 Würzburg\r\nTelefon: 0931 304 976 24\r\nE-Mail: mschoenmann@datenschutz-sued.de' WHERE `strings`.`identifier` = 'privacy_policy_officials_diocese_wuerzburg_paragraph';
UPDATE `strings` SET `de` = 'Stand vom 03.12.2020' WHERE `strings`.`identifier` = 'legal_notice_effective';