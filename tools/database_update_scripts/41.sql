CREATE TABLE `account_session_otps` ( `OTP` VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , `expires` DATETIME NOT NULL , `userId` INT(10) UNSIGNED NOT NULL , PRIMARY KEY (`OTP`)) ENGINE = InnoDB;
ALTER TABLE `account_session_otps` ADD CONSTRAINT `fk_account_session_otps_userId` FOREIGN KEY (`userId`) REFERENCES `account_data`(`userId`) ON DELETE CASCADE ON UPDATE CASCADE;
CREATE TABLE `account_session_hashs` ( `sessionHash` VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , `expires` DATETIME NOT NULL , `OTP` VARCHAR(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL , PRIMARY KEY (`sessionHash`)) ENGINE = InnoDB;
ALTER TABLE `account_session_hashs` ADD CONSTRAINT `fk_account_session_hashs_OTP` FOREIGN KEY (`OTP`) REFERENCES `account_session_otps`(`OTP`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `account_session_hashs` ADD UNIQUE( `OTP`);
ALTER TABLE `account_data` DROP `sessionHash`;
UPDATE `strings` SET `en` = '+ added HTML content for news and event details\r\n\r\n+ added support for concurrent account sessions across multiple devices\r\n\r\n* reworked push notifications to use the browser\'s native push service instead of 3rd party (firebase) service for better reliability and data privacy reasons\r\n\r\n* improved security for account sessions', `de` = '+ HTML-Inhalte für Neuigkeits- und Veranstaltungsdetails\r\n\r\n+ Unterstützung gleichzeitiger Account-Sitzungen über mehrere Geräte hinzugefügt\r\n\r\n* Sicherheit der Sitzungsverwaltung verbessert\r\n\r\n* Push-Benachrichtigungen für bessere Verlässlichkeit und Datenschutzgründen überarbeitet, indem der native Push Service des Browsers anstelle eines Drittanbieter (Firebase) Services genutzt wird' WHERE `strings`.`identifier` = 'changelog_1_1_0';